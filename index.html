<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>TSE</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<style>
/* ===== THEME ===== */
:root{
  --bg:#070a12;
  --panel:rgba(255,255,255,.08);
  --panel2:rgba(255,255,255,.12);
  --stroke:rgba(255,255,255,.14);
  --text:#fff;
  --muted:rgba(255,255,255,.6);
  --accent:#7c5cff;
  --radius:16px;
}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
}

/* ===== LAYOUT ===== */
header{
  padding:14px 20px;
  border-bottom:1px solid var(--stroke);
  display:flex;
  justify-content:space-between;
}
.tabs{display:flex;gap:10px}
.tab{
  padding:8px 14px;
  border-radius:999px;
  border:1px solid var(--stroke);
  background:var(--panel);
  cursor:pointer;
}
.tab.active{background:rgba(124,92,255,.3)}

main{padding:16px}
.section{display:none}
.section.active{display:block}

/* ===== SPLIT VIEW ===== */
.split{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
@media(max-width:900px){
  .split{grid-template-columns:1fr}
}

/* ===== PLAYER ===== */
video{width:100%;border-radius:14px;background:#000}

/* ===== DOC SYSTEM ===== */
.doc{
  background:var(--panel);
  border:1px solid var(--stroke);
  border-radius:14px;
  padding:10px;
}
.docTabs{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  margin-bottom:6px;
}
.docTab{
  padding:6px 10px;
  border-radius:10px;
  border:1px solid var(--stroke);
  cursor:pointer;
}
.docTab.active{background:rgba(124,92,255,.25)}
.toolbar{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  margin-bottom:6px;
}
.toolbar button,input[type=color],select{
  background:var(--panel2);
  border:1px solid var(--stroke);
  color:var(--text);
  border-radius:8px;
  padding:6px;
}
.editor{
  min-height:260px;
  background:#000;
  padding:10px;
  border-radius:10px;
}
.editor img{
  max-width:100%;
  border-radius:10px;
  cursor:pointer;
}
.editor img.selected{
  outline:2px solid var(--accent);
}

/* ===== NEWS ===== */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.65);
  display:none;
  align-items:center;
  justify-content:center;
}
.modal.show{display:flex}
.modal iframe{
  width:92vw;
  height:92vh;
  border-radius:16px;
  border:none;
}
</style>
</head>

<body>

<header>
  <b>TSE</b>
  <div class="tabs">
    <div class="tab active" data-tab="videos">Videos</div>
    <div class="tab" data-tab="news">News</div>
  </div>
</header>

<main>

<!-- ===== VIDEOS + NOTES ===== -->
<section id="videos" class="section active">

<div class="split">

<!-- PLAYER -->
<div>
  <video id="video" controls></video>
  <button onclick="insertTimestamp()">+ Timestamp</button>
</div>

<!-- DOCS -->
<div class="doc">

  <div class="docTabs" id="docTabs"></div>

  <div class="toolbar">
    <button onclick="cmd('bold')">B</button>
    <button onclick="cmd('italic')">I</button>
    <button onclick="cmd('underline')">U</button>
    <select onchange="cmd('fontSize',this.value)">
      <option value="3">Text</option>
      <option value="4">Large</option>
      <option value="5">XL</option>
    </select>
    <input type="color" onchange="cmd('foreColor',this.value)">
    <button onclick="exportPDF()">Export PDF</button>
    <button onclick="addDoc()">+ Doc</button>
  </div>

  <div id="editor" class="editor" contenteditable></div>

</div>
</div>
</section>

<!-- ===== NEWS ===== -->
<section id="news" class="section">
<h2>Market News</h2>
<button onclick="openNews('https://www.forexfactory.com')">Forex Factory</button>
<button onclick="openNews('https://www.reuters.com/markets')">Reuters</button>
<button onclick="openNews('https://www.investing.com')">Investing.com</button>
<button onclick="openNews('https://www.bloomberg.com/markets')">Bloomberg</button>
<button onclick="openNews('https://www.cmegroup.com/market-data/economic-calendar.html')">CME Calendar</button>
</section>

</main>

<div id="newsModal" class="modal" onclick="this.classList.remove('show')">
  <iframe id="newsFrame"></iframe>
</div>

<script>
/* ===== TABS ===== */
document.querySelectorAll('.tab').forEach(t=>{
  t.onclick=()=>{
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'))
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'))
    t.classList.add('active')
    document.getElementById(t.dataset.tab).classList.add('active')
  }
})

/* ===== DOC STATE ===== */
let docs={
  active:'doc-1',
  docs:{
    'doc-1':{title:'Notes',html:''}
  }
}

/* ===== DOC UI ===== */
function renderTabs(){
  const el=document.getElementById('docTabs')
  el.innerHTML=''
  Object.entries(docs.docs).forEach(([id,d])=>{
    const t=document.createElement('div')
    t.className='docTab'+(docs.active===id?' active':'')
    t.textContent=d.title
    t.onclick=()=>switchDoc(id)
    el.appendChild(t)
  })
}
function switchDoc(id){
  saveDoc()
  docs.active=id
  document.getElementById('editor').innerHTML=docs.docs[id].html
  renderTabs()
}
function saveDoc(){
  docs.docs[docs.active].html=document.getElementById('editor').innerHTML
  localStorage.setItem('tse-docs',JSON.stringify(docs))
}
function addDoc(){
  const id='doc-'+Date.now()
  docs.docs[id]={title:'New Doc',html:''}
  switchDoc(id)
}

/* ===== COMMANDS ===== */
function cmd(c,v=null){document.execCommand(c,false,v)}

/* ===== TIMESTAMPS ===== */
function insertTimestamp(){
  const t=Math.floor(document.getElementById('video').currentTime)
  document.execCommand('insertHTML',false,
    `<span style="color:#7c5cff;cursor:pointer" onclick="document.getElementById('video').currentTime=${t}">[${t}s]</span> `
  )
}

/* ===== EXPORT PDF ===== */
function exportPDF(){
  const w=window.open('')
  w.document.write(`<html><body>${document.getElementById('editor').innerHTML}</body></html>`)
  w.print()
}

/* ===== NEWS ===== */
function openNews(url){
  document.getElementById('newsFrame').src=url
  document.getElementById('newsModal').classList.add('show')
}

/* ===== INIT ===== */
const saved=localStorage.getItem('tse-docs')
if(saved){docs=JSON.parse(saved)}
renderTabs()
switchDoc(docs.active)
setInterval(saveDoc,2000)
</script>

</body>
</html>
