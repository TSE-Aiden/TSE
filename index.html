<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>TSE</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
/* =================== THEME =================== */
:root {
  --bg: #0b0e14;
  --panel: rgba(18,22,36,.85);
  --panel-strong: #121826;
  --border: rgba(255,255,255,.08);
  --accent: #6d7cff;
  --accent-soft: rgba(109,124,255,.15);
  --text: #e6e9f2;
  --muted: #9aa4c7;
}

* { box-sizing: border-box; }
body {
  margin: 0;
  background:
    radial-gradient(1200px 600px at 50% -200px, #1a2140, transparent),
    var(--bg);
  color: var(--text);
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
}

/* =================== HEADER =================== */
header {
  padding: 18px 28px;
  font-weight: 800;
  letter-spacing: .6px;
  font-size: 18px;
}

/* =================== TABS =================== */
.tabs {
  display: flex;
  gap: 10px;
  padding: 0 28px 16px;
}
.tab {
  padding: 8px 16px;
  border-radius: 999px;
  background: var(--panel);
  border: 1px solid var(--border);
  cursor: pointer;
  opacity: .6;
}
.tab.active {
  background: var(--accent-soft);
  border-color: var(--accent);
  opacity: 1;
}

/* =================== LAYOUT =================== */
main { padding: 0 28px 40px; }
.panel {
  background: linear-gradient(180deg, #141a30, #0e1324);
  border: 1px solid var(--border);
  border-radius: 18px;
  padding: 16px;
  margin-bottom: 20px;
}
.hidden { display: none; }

/* =================== VIDEO =================== */
.video-layout {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 16px;
}
video {
  width: 100%;
  background: black;
  border-radius: 14px;
}
.timestamp {
  font-size: 12px;
  color: var(--muted);
  margin-top: 6px;
}

/* =================== NOTES =================== */
.notes-panel {
  display: flex;
  flex-direction: column;
  height: 100%;
}
.toolbar {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 10px;
}
.toolbar button, .toolbar select, .toolbar input {
  background: #1a2140;
  color: white;
  border: 1px solid #2a3470;
  border-radius: 6px;
  padding: 6px 8px;
}
#editor {
  flex: 1;
  padding: 14px;
  background: #0a0f1f;
  border: 1px solid #2a3470;
  border-radius: 12px;
  outline: none;
  overflow-y: auto;
}
#editor img {
  max-width: 100%;
  resize: both;
  border: 1px dashed #555;
  margin: 6px 0;
}

/* =================== FOLDERS =================== */
.folders {
  display: flex;
  gap: 10px;
  margin-bottom: 10px;
}
.folder {
  padding: 6px 12px;
  border-radius: 999px;
  background: #1a2140;
  border: 1px solid #2a3470;
  cursor: pointer;
}

/* =================== NEWS =================== */
iframe {
  width: 100%;
  height: 70vh;
  border: none;
  border-radius: 14px;
}

/* =================== BIBLE =================== */
.bible-lesson {
  line-height: 1.6;
}
.bible-lesson h4 {
  margin-top: 14px;
}
</style>
</head>

<body>

<header>TSE</header>

<div class="tabs">
  <div class="tab active" data-tab="videos">Videos</div>
  <div class="tab" data-tab="notes">Notes</div>
  <div class="tab" data-tab="bible">Daily Bible Study</div>
  <div class="tab" data-tab="news">News</div>
</div>

<main>

<!-- ================= VIDEOS ================= -->
<div id="videos" class="panel">
  <div class="video-layout">
    <div>
      <video id="player" controls></video>
      <div class="timestamp">Safe player · no duration dependency</div>
    </div>

    <div class="notes-panel">
      <strong>Quick Notes</strong>
      <div id="quickNotes" contenteditable="true" style="
        flex:1;
        margin-top:8px;
        background:#0a0f1f;
        border:1px solid #2a3470;
        border-radius:12px;
        padding:12px;">
        Jot thoughts while watching…
      </div>
    </div>
  </div>

  <button id="loadDemo" style="margin-top:12px;">Load demo video</button>
</div>

<!-- ================= NOTES ================= -->
<div id="notes" class="panel hidden">
  <h3>Notes Document</h3>

  <div class="toolbar">
    <button data-style="bold">B</button>
    <button data-style="italic">I</button>
    <button data-style="underline">U</button>
    <input type="color" id="colorPicker" />
    <select id="fontSize">
      <option value="14px">14</option>
      <option value="16px">16</option>
      <option value="20px">20</option>
      <option value="28px">28</option>
    </select>
    <input type="file" id="imgUpload" accept="image/*" />
    <button id="exportPDF">Export PDF</button>
  </div>

  <div id="editor" contenteditable="true">
    This is a full document.  
    Resize images.  
    Color text.  
    Journal freely.
  </div>
</div>

<!-- ================= BIBLE ================= -->
<div id="bible" class="panel hidden">
  <h3>Daily Bible Study</h3>

  <input id="verseInput" placeholder="John 3:16" />
  <button id="loadVerse">Generate Lesson</button>

  <div id="bibleContent" class="bible-lesson"></div>
</div>

<!-- ================= NEWS ================= -->
<div id="news" class="panel hidden">
  <h3>Market News Terminal</h3>

  <select id="newsSelect">
    <option value="">Select source</option>
    <option value="https://www.forexfactory.com">Forex Factory</option>
    <option value="https://www.investing.com">Investing.com</option>
    <option value="https://www.marketwatch.com">MarketWatch</option>
    <option value="https://www.bloomberg.com/markets">Bloomberg Markets</option>
  </select>

  <iframe id="newsFrame"></iframe>
</div>

</main>

<script>
/* ================= SAFETY ================= */
window.onerror = e => console.warn("Error isolated:", e);

/* ================= TABS ================= */
document.querySelectorAll(".tab").forEach(tab => {
  tab.onclick = () => {
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    document.querySelectorAll(".panel").forEach(p => p.classList.add("hidden"));
    tab.classList.add("active");
    document.getElementById(tab.dataset.tab).classList.remove("hidden");
  };
});

/* ================= VIDEO ================= */
const player = document.getElementById("player");
document.getElementById("loadDemo").onclick = () => {
  player.pause();
  player.removeAttribute("src");
  player.load();
  player.src = "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4";
};

/* ================= NOTES ================= */
function applyStyle(style, value) {
  const sel = window.getSelection();
  if (!sel.rangeCount) return;
  const range = sel.getRangeAt(0);
  if (range.collapsed) return;
  const span = document.createElement("span");
  span.style[style] = value;
  range.surroundContents(span);
}

document.querySelectorAll("[data-style]").forEach(btn => {
  btn.onclick = () => {
    const map = {
      bold: ["fontWeight","700"],
      italic: ["fontStyle","italic"],
      underline: ["textDecoration","underline"]
    };
    applyStyle(...map[btn.dataset.style]);
  };
});
document.getElementById("colorPicker").oninput = e =>
  applyStyle("color", e.target.value);
document.getElementById("fontSize").onchange = e =>
  applyStyle("fontSize", e.target.value);

document.getElementById("imgUpload").onchange = e => {
  const f = e.target.files[0];
  if (!f) return;
  const img = document.createElement("img");
  img.src = URL.createObjectURL(f);
  document.getElementById("editor").appendChild(img);
};

/* ================= BIBLE ================= */
document.getElementById("loadVerse").onclick = async () => {
  const ref = document.getElementById("verseInput").value || "Psalm 23:1";
  const out = document.getElementById("bibleContent");
  out.textContent = "Loading…";
  try {
    const r = await fetch(`https://bible-api.com/${encodeURIComponent(ref)}`);
    const d = await r.json();
    out.innerHTML = `
      <h4>${d.reference}</h4>
      <p>${d.text}</p>
      <h4>Observe</h4><p>What does this show about God?</p>
      <h4>Interpret</h4><p>What does it mean?</p>
      <h4>Apply</h4><p>How should this change you?</p>
      <h4>Prayer</h4><p>Write a prayer response.</p>`;
  } catch {
    out.textContent = "Failed to load lesson.";
  }
};

/* ================= NEWS ================= */
document.getElementById("newsSelect").onchange = e =>
  document.getElementById("newsFrame").src = e.target.value;
</script>

</body>
</html>
